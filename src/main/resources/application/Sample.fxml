<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.Cursor?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.shape.Circle?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ListView?>
<?import javafx.scene.control.ProgressIndicator?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.SplitPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.TitledPane?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.layout.TilePane?>

<BorderPane prefHeight="720" prefWidth="1350" stylesheets="@application.css" xmlns="http://javafx.com/javafx/23.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="application.SampleController">

  <top>
    <HBox alignment="CENTER" style="-fx-background-color: white; -fx-effect: dropshadow(gaussian,rgba(0,0,0,0.08),0,0,0,4);">
      <Label style="-fx-text-fill: #2c3e50; -fx-font-size: 22px; -fx-font-weight: bold; -fx-padding: 10 0 10 0;" text="Attendance Management System" />
    </HBox>
  </top>

  <center>
    <SplitPane dividerPositions="0.23, 0.77" orientation="HORIZONTAL">
      <items>
        <!-- Left: User Data & Templates -->
        <TitledPane collapsible="false" expanded="true" maxWidth="350" prefHeight="764.0" prefWidth="307.0" style="-fx-font-size: 18px; -fx-text-fill: white; -fx-background-color: #4a6741;" text="DATA">
          <content>
            <ScrollPane fitToHeight="true" fitToWidth="true" hbarPolicy="NEVER">
              <content>
                <VBox fillWidth="false" maxWidth="-Infinity" minWidth="-Infinity" prefWidth="300.0" spacing="10">
                  <padding>
                    <Insets bottom="10" left="10" right="10" top="10" />
                  </padding>
                  <ComboBox fx:id="personSelect" promptText="USER" />
                  <!-- ID -->
                  <HBox spacing="3">
                    <Label text="ID:">
                                 <HBox.margin>
                                    <Insets top="7.0" />
                                 </HBox.margin>
                              </Label>
                    <TextField fx:id="idField" maxHeight="-Infinity" maxWidth="-Infinity" minWidth="0.0" prefHeight="37.0" prefWidth="310.0" promptText="Student ID" HBox.hgrow="ALWAYS" />
                  </HBox>
                  <HBox spacing="3">
                    <Label text="Name:">
                                 <HBox.margin>
                                    <Insets top="7.0" />
                                 </HBox.margin>
                              </Label>
                    <TextField fx:id="nameField" maxHeight="-Infinity" maxWidth="-Infinity" minHeight="-Infinity" minWidth="-Infinity" prefHeight="37.0" prefWidth="197.0" promptText="Enter Name" HBox.hgrow="ALWAYS" />
                  </HBox>
                  <HBox spacing="1">
                    <Label text="Department:">
                                 <HBox.margin>
                                    <Insets top="7.0" />
                                 </HBox.margin>
                              </Label>
                    <TextField fx:id="deptField" maxWidth="-Infinity" minWidth="-Infinity" prefHeight="37.0" prefWidth="105.0" promptText="Enter Department" HBox.hgrow="ALWAYS" />
                  </HBox>
                  <HBox spacing="3">
                    <Label text="Position:">
                                 <HBox.margin>
                                    <Insets top="7.0" />
                                 </HBox.margin>
                              </Label>
                    <TextField fx:id="posField" maxWidth="-Infinity" minWidth="-Infinity" promptText="Student / Teacher" HBox.hgrow="ALWAYS" />
                  </HBox>
                  <!-- Schedule Container -->
                  <VBox spacing="3" style="-fx-background-color: #f0f7ed; -fx-padding: 10; -fx-background-radius: 8;">
                    <Label style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #4a6741;" text="Schedule" />
                    <HBox spacing="1">
                      <Label text="Day:">
                                    <HBox.margin>
                                       <Insets top="19.0" />
                                    </HBox.margin>
                                 </Label>
                      <ComboBox fx:id="scheduleDayCombo" opacity="0.8" HBox.hgrow="ALWAYS">
                                    <cursor>
                                       <Cursor fx:constant="OPEN_HAND" />
                                    </cursor>
                                    <HBox.margin>
                                       <Insets left="7.0" top="6.0" />
                                    </HBox.margin>
                                 </ComboBox>
                    </HBox>
                    <HBox spacing="1">
                      <Label text="Start:">
                                    <HBox.margin>
                                       <Insets top="19.0" />
                                    </HBox.margin>
                                 </Label>
                      <ComboBox fx:id="scheduleStartCombo" opacity="0.8" HBox.hgrow="ALWAYS">
                                    <cursor>
                                       <Cursor fx:constant="OPEN_HAND" />
                                    </cursor>
                                    <HBox.margin>
                                       <Insets left="3.0" top="6.0" />
                                    </HBox.margin>
                                 </ComboBox>
                    </HBox>
                    <HBox spacing="1">
                      <Label text="End:">
                                    <HBox.margin>
                                       <Insets top="19.0" />
                                    </HBox.margin>
                                 </Label>
                      <ComboBox fx:id="scheduleEndCombo" opacity="0.8" HBox.hgrow="ALWAYS">
                                    <cursor>
                                       <Cursor fx:constant="OPEN_HAND" />
                                    </cursor>
                                    <HBox.margin>
                                       <Insets left="7.0" top="6.0" />
                                    </HBox.margin>
                                 </ComboBox>
                    </HBox>
                    <HBox spacing="1">
                      <Label text="Activity:">
                                    <HBox.margin>
                                       <Insets top="23.0" />
                                    </HBox.margin>
                                 </Label>
                      <TextField fx:id="scheduleActivity" maxHeight="-Infinity" maxWidth="-Infinity" minHeight="-Infinity" minWidth="-Infinity" opacity="0.8" promptText="Subject" HBox.hgrow="ALWAYS">
                                    <cursor>
                                       <Cursor fx:constant="DEFAULT" />
                                    </cursor>
                                    <HBox.margin>
                                       <Insets left="2.0" top="15.0" />
                                    </HBox.margin>
                                 </TextField>
                    </HBox>
                    <Button fx:id="addScheduleBtn" onAction="#addSchedule" styleClass="button" text="Add Schedule">
                                 <VBox.margin>
                                    <Insets top="20.0" />
                                 </VBox.margin>
                              </Button>
                  </VBox>
                </VBox>
              </content>
            </ScrollPane>
          </content>
        </TitledPane>

        <!-- Center: Camera, Tables, Buttons -->
        <VBox fillWidth="true" spacing="10">
          <HBox alignment="CENTER">
            <ImageView fx:id="cameraView" fitHeight="280" fitWidth="500" preserveRatio="true" scaleX="-1" VBox.vgrow="NEVER" />
          </HBox>
          <HBox fx:id="actionButtonsBox" alignment="CENTER" spacing="20" VBox.vgrow="NEVER">
            <Button fx:id="startCameraBtn" onAction="#onStartCamera" text="Start Cam" />
            <Button fx:id="stopCameraBtn" onAction="#onStopCamera" text="Stop Cam" />
            <Button fx:id="removePersonBtn" onAction="#onRemovePerson" text="Remove" />
            <Button fx:id="saveFaceBtn" onAction="#onSaveFace" text="Save Face" />
            <Button fx:id="recognizeBtn" onAction="#onRecognize" text="Recognize" />
            <ProgressIndicator fx:id="pb" visible="false" />
          </HBox>
          <HBox alignment="CENTER" spacing="30" style="-fx-background-color: transparent;">
            <Label fx:id="attendanceLabel" onMouseClicked="#showAttendanceTable" styleClass="switch-label-selected" text="Attendance Log" />
            <Label fx:id="scheduleLabel" onMouseClicked="#showScheduleTable" styleClass="switch-label" text="Schedule" />
          </HBox>
          <StackPane fx:id="tableStack" VBox.vgrow="ALWAYS">
            <TableView fx:id="attendanceTable" prefHeight="200" prefWidth="721.0" visible="true" VBox.vgrow="ALWAYS">
              <columns>
                <TableColumn fx:id="timeColumn" prefWidth="120.0" resizable="false" text="Time" />
                <TableColumn fx:id="nameColumn" prefWidth="200.0" resizable="false" text="Name" />
                <TableColumn fx:id="dateColumn" prefWidth="120.0" resizable="false" text="Date" />
                <TableColumn fx:id="activityColumnLog" prefWidth="100.0" text="Activity" />
                <TableColumn fx:id="eventTypeColumn" minWidth="120.0" prefWidth="100.0" text="Type" />
              </columns>
            </TableView>
            <TableView fx:id="scheduleTable" managed="false" visible="false" VBox.vgrow="ALWAYS">
              <columns>
                <TableColumn fx:id="dayColumn" prefWidth="140.0" resizable="false" text="Day" />
                <TableColumn fx:id="startTimeColumn" prefWidth="140.0" resizable="false" text="Start Time" />
                <TableColumn fx:id="endTimeColumn" prefWidth="140.0" resizable="false" text="End Time" />
                <TableColumn fx:id="activityColumn" prefWidth="140.0" resizable="false" text="Activity" />
              </columns>
            </TableView>
          </StackPane>
        </VBox>

        <!-- Right: Event Log & OCR (stick to top) -->
        <VBox fillWidth="true" spacing="0">
          <TitledPane collapsible="true" expanded="false" maxWidth="350" style="-fx-font-size: 18px; -fx-text-fill: white; -fx-background-color: #4a6741;" text="Event Log &amp; OCR">
            <content>
              <VBox fillWidth="true" spacing="10">
                <Label style="-fx-font-weight: bold; -fx-font-size: 15px; -fx-text-fill: #4a6741;" text="Event Log:" />
                <ListView fx:id="logList" VBox.vgrow="ALWAYS" />
              </VBox>
            </content>
          </TitledPane>
          <VBox VBox.vgrow="ALWAYS">
            <VBox alignment="CENTER" spacing="10">
                <Label style="-fx-font-weight: bold; -fx-font-size: 15px; -fx-padding: 10 0 0 0;" text="Selected Template:" />
                <HBox alignment="CENTER">
                    <StackPane alignment="CENTER">
                        <ImageView fx:id="selectedTemplateView" fitHeight="120" fitWidth="120" preserveRatio="true">
                            <clip>
                                <Circle centerX="60" centerY="60" radius="60" />
                            </clip>
                        </ImageView>
                    </StackPane>
                </HBox>
                <HBox alignment="CENTER" spacing="15">
                    <Button fx:id="retakeTemplateBtn" onAction="#onRetakeTemplate" text="Retake" />
                </HBox>
            </VBox>
          </VBox>
        </VBox>
      </items>
    </SplitPane>
  </center>
</BorderPane>
