<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx/23" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.icefx.controller.AdminController"
            styleClass="root-container"
            stylesheets="@../styles/enterprise-theme.css">

    <top>
        <HBox styleClass="header-bar" alignment="CENTER_LEFT" spacing="20">
            <padding>
                <Insets topRightBottomLeft="16"/>
            </padding>
            
            <Label text="IceFX Administration" styleClass="header-title"/>
            
            <Region HBox.hgrow="ALWAYS"/>
            
            <VBox alignment="CENTER_RIGHT" spacing="2">
                <Label fx:id="currentUserLabel" text="Admin User" styleClass="header-user-name"/>
                <Label text="Administrator" styleClass="header-user-role"/>
            </VBox>
            
            <Button text="Logout" styleClass="btn, btn-outlined, btn-error" onAction="#handleLogout">
                <graphic>
                    <Label text="ðŸšª" style="-fx-font-size: 16px;"/>
                </graphic>
            </Button>
        </HBox>
    </top>

    <center>
        <HBox spacing="20" styleClass="content-area">
            <padding>
                <Insets topRightBottomLeft="20"/>
            </padding>

            <VBox spacing="16" HBox.hgrow="ALWAYS">
                
                <HBox spacing="16">
                    <VBox styleClass="card, stat-card" HBox.hgrow="ALWAYS" spacing="8">
                        <Label text="Total Users" styleClass="stat-label"/>
                        <Label fx:id="userCountLabel" text="0" styleClass="stat-value"/>
                    </VBox>
                    
                    <VBox styleClass="card, stat-card" HBox.hgrow="ALWAYS" spacing="8">
                        <Label text="Selected User" styleClass="stat-label"/>
                        <Label fx:id="selectedUserLabel" text="None" styleClass="stat-value-small"/>
                    </VBox>
                </HBox>

                <VBox styleClass="card" spacing="12" VBox.vgrow="ALWAYS">
                    <HBox alignment="CENTER_LEFT" spacing="12">
                        <Label text="User Management" styleClass="card-title" HBox.hgrow="ALWAYS"/>
                        <Button text="âž• Add User" styleClass="btn, btn-primary, btn-sm" onAction="#handleAddUser"/>
                    </HBox>
                    
                    <TableView fx:id="userTable" styleClass="modern-table" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="userIdColumn" text="User ID" prefWidth="100"/>
                            <TableColumn fx:id="userNameColumn" text="Name" prefWidth="150"/>
                            <TableColumn fx:id="roleColumn" text="Role" prefWidth="100"/>
                            <TableColumn fx:id="statusColumn" text="Status" prefWidth="80"/>
                            <TableColumn fx:id="actionsColumn" text="Actions" prefWidth="150"/>
                        </columns>
                        <placeholder>
                            <VBox alignment="CENTER" spacing="12" style="-fx-padding: 60px;">
                                <Label text="ðŸ‘¥" style="-fx-font-size: 48px; -fx-opacity: 0.3;"/>
                                <Label text="No users found" styleClass="text-muted" style="-fx-font-size: 16px;"/>
                                <Label text="Click 'Add User' to create your first user" styleClass="text-muted"/>
                            </VBox>
                        </placeholder>
                    </TableView>
                </VBox>
            </VBox>

            <VBox spacing="16" prefWidth="400" minWidth="400" maxWidth="400">
                
                <VBox styleClass="card" spacing="16">
                    <Label text="User Details" styleClass="card-title"/>
                    
                    <VBox spacing="8">
                        <Label text="User ID" styleClass="form-label"/>
                        <TextField fx:id="userIdField" styleClass="form-input" promptText="e.g., STU001"/>
                    </VBox>
                    
                    <VBox spacing="8">
                        <Label text="Full Name" styleClass="form-label"/>
                        <TextField fx:id="nameField" styleClass="form-input" promptText="Enter full name"/>
                    </VBox>
                    
                    <VBox spacing="8">
                        <Label text="Password" styleClass="form-label"/>
                        <PasswordField fx:id="passwordField" styleClass="form-input" promptText="Enter password"/>
                    </VBox>
                    
                    <VBox spacing="8">
                        <Label text="Role" styleClass="form-label"/>
                        <ComboBox fx:id="roleComboBox" styleClass="form-input" maxWidth="Infinity"/>
                    </VBox>
                    
                    <VBox spacing="8">
                        <Label text="Status" styleClass="form-label"/>
                        <ComboBox fx:id="statusComboBox" styleClass="form-input" maxWidth="Infinity"/>
                    </VBox>
                    
                    <HBox spacing="12">
                        <Button text="ðŸ’¾ Save" styleClass="btn, btn-success" onAction="#handleSaveUser" HBox.hgrow="ALWAYS" maxWidth="Infinity"/>
                        <Button text="ðŸ—‘ï¸ Delete" styleClass="btn, btn-error" onAction="#handleDeleteUser" HBox.hgrow="ALWAYS" maxWidth="Infinity"/>
                        <Button text="Clear" styleClass="btn, btn-outlined" onAction="#handleClearForm" HBox.hgrow="ALWAYS" maxWidth="Infinity"/>
                    </HBox>
                </VBox>

                <VBox styleClass="card" spacing="16" VBox.vgrow="ALWAYS">
                    <Label text="Face Training" styleClass="card-title"/>
                    
                    <HBox spacing="12">
                        <VBox styleClass="info-box" HBox.hgrow="ALWAYS" spacing="4">
                            <Label text="Total Faces" styleClass="text-muted" style="-fx-font-size: 11px;"/>
                            <Label fx:id="totalFacesLabel" text="0" styleClass="text-large" style="-fx-font-weight: bold;"/>
                        </VBox>
                        
                        <VBox styleClass="info-box" HBox.hgrow="ALWAYS" spacing="4">
                            <Label text="Last Trained" styleClass="text-muted" style="-fx-font-size: 11px;"/>
                            <Label fx:id="lastTrainedLabel" text="Never" styleClass="text-small" style="-fx-font-weight: bold;"/>
                        </VBox>
                    </HBox>
                    
                    <VBox fx:id="trainingProgressBox" spacing="8" visible="false" managed="false">
                        <Label text="Training in progress..." styleClass="text-muted"/>
                        <ProgressBar fx:id="trainingProgress" maxWidth="Infinity" progress="0"/>
                    </VBox>
                    
                    <VBox spacing="8" styleClass="info-box">
                        <HBox spacing="8" alignment="CENTER_LEFT">
                            <Label text="â„¹ï¸" style="-fx-font-size: 16px;"/>
                            <Label text="Face Training Information" styleClass="text-small" style="-fx-font-weight: bold;"/>
                        </HBox>
                        <Label text="â€¢ Select a user from the table" styleClass="text-muted" style="-fx-font-size: 12px;" wrapText="true"/>
                        <Label text="â€¢ Capture multiple face samples" styleClass="text-muted" style="-fx-font-size: 12px;" wrapText="true"/>
                        <Label text="â€¢ Train the recognition model" styleClass="text-muted" style="-fx-font-size: 12px;" wrapText="true"/>
                    </VBox>
                    
                    <Region VBox.vgrow="ALWAYS"/>
                    
                    <VBox spacing="12">
                        <Button text="ðŸ“¸ Capture Face" styleClass="btn, btn-primary" onAction="#handleCaptureFace" maxWidth="Infinity"/>
                        <Button text="ðŸŽ¯ Train Model" styleClass="btn, btn-success" onAction="#handleTrainModel" maxWidth="Infinity"/>
                        <Button text="ðŸ”„ Retrain All" styleClass="btn, btn-warning" onAction="#handleRetrainAll" maxWidth="Infinity"/>
                    </VBox>
                </VBox>
            </VBox>
        </HBox>
    </center>

    <bottom>
        <HBox styleClass="footer-bar" alignment="CENTER" spacing="8">
            <padding>
                <Insets topRightBottomLeft="12"/>
            </padding>
            <Label text="IceFX Administration Panel v2.0" styleClass="footer-text"/>
            <Label text="â€¢" styleClass="footer-text"/>
            <Label text="User & Face Management System" styleClass="footer-text"/>
        </HBox>
    </bottom>

</BorderPane>
