<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<StackPane xmlns="http://javafx.com/javafx/23" xmlns:fx="http://javafx.com/fxml/1"
           fx:controller="com.icefx.controller.LoginController"
           styleClass="root-container"
           stylesheets="@../styles/enterprise-theme.css">

    <!-- Animated Gradient Background -->
    <VBox alignment="CENTER" spacing="0" style="-fx-background-color: #667eea;">
        
        <!-- Main Login Card -->
        <VBox alignment="CENTER" spacing="36" maxWidth="500" 
              style="-fx-background-color: white; -fx-background-radius: 20px; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.25), 50, 0, 0, 10); -fx-padding: 56px 64px;">
            
            <!-- Logo & Branding -->
            <VBox alignment="CENTER" spacing="12">
                <Label text="ðŸŽ¯" style="-fx-font-size: 64px; -fx-alignment: center;"/>
                <Label text="IceFX Attendance" style="-fx-font-size: 32px; -fx-font-weight: 700; -fx-text-fill: #667eea; -fx-alignment: center;"/>
                <Label text="Facial Recognition Powered System" styleClass="text-muted" style="-fx-font-size: 15px; -fx-alignment: center;"/>
            </VBox>
            
            <Separator prefWidth="340" style="-fx-opacity: 0.15;"/>
            
            <!-- Welcome Text -->
            <VBox alignment="CENTER" spacing="6" maxWidth="380">
                <Label fx:id="welcomeTitle" text="Welcome!" style="-fx-font-size: 26px; -fx-font-weight: 600; -fx-text-fill: #1e293b; -fx-alignment: center;"/>
                <Label fx:id="welcomeSubtitle" text="Select your role to continue" style="-fx-font-size: 14px; -fx-text-fill: #64748b; -fx-alignment: center;"/>
            </VBox>
            
            <!-- Role Selection (Default View) -->
            <VBox fx:id="roleSelectionBox" spacing="20" prefWidth="380" maxWidth="380">
                
                <!-- Student Button -->
                <Button text="ðŸ‘¨â€ðŸŽ“ I'm a Student" 
                        styleClass="btn"
                        onAction="#handleStudentRole"
                        maxWidth="Infinity"
                        style="-fx-pref-height: 80px; -fx-font-size: 20px; -fx-font-weight: 700; -fx-background-radius: 12px; -fx-background-color: #10b981; -fx-text-fill: white;">
                    <tooltip>
                        <Tooltip text="Automatic face recognition - No login required"/>
                    </tooltip>
                </Button>
                
                <Label text="or" style="-fx-font-size: 14px; -fx-text-fill: #94a3b8; -fx-alignment: center;"/>
                
                <!-- Admin Button -->
                <Button text="ðŸ‘¨â€ðŸ’¼ I'm an Admin" 
                        styleClass="btn"
                        onAction="#handleAdminRole"
                        maxWidth="Infinity"
                        style="-fx-pref-height: 80px; -fx-font-size: 20px; -fx-font-weight: 700; -fx-background-radius: 12px; -fx-background-color: #667eea; -fx-text-fill: white;">
                    <tooltip>
                        <Tooltip text="Requires username and password"/>
                    </tooltip>
                </Button>
                
                <!-- Info Text -->
                <VBox spacing="8" alignment="CENTER" style="-fx-padding: 20 0 0 0;">
                    <Label text="ðŸ’¡ Students - Just look at the camera" style="-fx-font-size: 13px; -fx-text-fill: #64748b; -fx-alignment: center;"/>
                    <Label text="ðŸ”’ Admins - Need credentials to access" style="-fx-font-size: 13px; -fx-text-fill: #64748b; -fx-alignment: center;"/>
                </VBox>
                
            </VBox>
            
            <!-- Admin Login Form (Hidden Initially) -->
            <VBox fx:id="loginFormBox" spacing="24" prefWidth="380" maxWidth="380" visible="false" managed="false">
                
                <!-- User Code Input -->
                <VBox spacing="10">
                    <Label text="ðŸ‘¤ Admin Code" styleClass="form-label" style="-fx-font-weight: 600; -fx-font-size: 14px;"/>
                    <TextField fx:id="userCodeField" 
                               styleClass="form-input"
                               promptText="Enter admin code (e.g., ADMIN001)"
                               style="-fx-pref-height: 48px; -fx-font-size: 15px; -fx-background-radius: 10px; -fx-border-radius: 10px;"/>
                </VBox>
                
                <!-- Password Input -->
                <VBox spacing="10">
                    <Label text="ðŸ”’ Password" styleClass="form-label" style="-fx-font-weight: 600; -fx-font-size: 14px;"/>
                    <PasswordField fx:id="passwordField" 
                                   styleClass="form-input"
                                   promptText="Enter your password"
                                   style="-fx-pref-height: 48px; -fx-font-size: 15px; -fx-background-radius: 10px; -fx-border-radius: 10px;"/>
                </VBox>
                
                <!-- Error Message -->
                <Label fx:id="errorLabel" 
                       styleClass="text-error"
                       wrapText="true"
                       visible="false"
                       style="-fx-padding: 14px; -fx-background-color: #fee2e2; -fx-background-radius: 10px; -fx-font-size: 13px; -fx-text-fill: #dc2626;"/>
                
                <!-- Buttons Row -->
                <HBox spacing="12">
                    <Button text="â† Back" 
                            styleClass="btn"
                            onAction="#handleBackToRoles"
                            style="-fx-pref-height: 52px; -fx-font-size: 16px; -fx-font-weight: 600; -fx-background-radius: 12px; -fx-background-color: #94a3b8; -fx-text-fill: white; -fx-min-width: 100px;"/>
                    
                    <Button fx:id="loginButton" 
                            text="Sign In" 
                            styleClass="btn, btn-primary"
                            onAction="#handleLogin"
                            defaultButton="true"
                            HBox.hgrow="ALWAYS"
                            style="-fx-pref-height: 52px; -fx-font-size: 17px; -fx-font-weight: 700; -fx-background-radius: 12px; -fx-background-color: #667eea; -fx-text-fill: white;"/>
                </HBox>
                
                <!-- Progress Indicator -->
                <StackPane>
                    <ProgressIndicator fx:id="progressIndicator" 
                                       visible="false"
                                       maxWidth="36"
                                       maxHeight="36"/>
                </StackPane>
                
            </VBox>
            
            <!-- Demo Credentials Card (Only shown in admin login) -->
            <VBox fx:id="demoCredentialsBox" spacing="12" styleClass="info-box" maxWidth="380" visible="false" managed="false"
                  style="-fx-background-color: #f8fafc; -fx-padding: 20px 24px; -fx-background-radius: 12px; -fx-border-color: #e2e8f0; -fx-border-width: 1px; -fx-border-radius: 12px;">
                <HBox spacing="10" alignment="CENTER_LEFT">
                    <Label text="ðŸ’¡" style="-fx-font-size: 20px;"/>
                    <Label text="Demo Admin Credentials" style="-fx-font-weight: 700; -fx-font-size: 15px; -fx-text-fill: #475569;"/>
                </HBox>
                <Label text="Admin: ADMIN001 / admin123" style="-fx-font-size: 13px; -fx-text-fill: #64748b; -fx-padding: 0 0 0 30;"/>
            </VBox>
            
        </VBox>
        
        <!-- Footer -->
        <VBox alignment="CENTER" spacing="10" style="-fx-padding: 36px;">
            <Label text="IceFX Attendance System v2.0" style="-fx-text-fill: white; -fx-font-size: 13px; -fx-opacity: 0.95; -fx-font-weight: 500;"/>
            <HBox spacing="14" alignment="CENTER">
                <Label text="OpenCV 4.9" style="-fx-text-fill: white; -fx-font-size: 12px; -fx-opacity: 0.85;"/>
                <Label text="â€¢" style="-fx-text-fill: white; -fx-opacity: 0.85;"/>
                <Label text="JavaFX 23" style="-fx-text-fill: white; -fx-font-size: 12px; -fx-opacity: 0.85;"/>
                <Label text="â€¢" style="-fx-text-fill: white; -fx-opacity: 0.85;"/>
                <Label text="JDK 23.0.1" style="-fx-text-fill: white; -fx-font-size: 12px; -fx-opacity: 0.85;"/>
            </HBox>
        </VBox>
        
    </VBox>
    
</StackPane>
